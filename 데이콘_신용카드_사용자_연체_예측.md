# **ÎùºÏù¥Î∏åÎü¨Î¶¨ Î∂àÎü¨Ïò§Í∏∞**


```python
!pip install catboost
```

    Collecting catboost
    [?25l  Downloading https://files.pythonhosted.org/packages/47/80/8e9c57ec32dfed6ba2922bc5c96462cbf8596ce1a6f5de532ad1e43e53fe/catboost-0.25.1-cp37-none-manylinux1_x86_64.whl (67.3MB)
    [K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 67.3MB 52kB/s 
    [?25hRequirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.19.5)
    Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from catboost) (1.4.1)
    Requirement already satisfied: graphviz in /usr/local/lib/python3.7/dist-packages (from catboost) (0.10.1)
    Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from catboost) (1.15.0)
    Requirement already satisfied: plotly in /usr/local/lib/python3.7/dist-packages (from catboost) (4.4.1)
    Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from catboost) (3.2.2)
    Requirement already satisfied: pandas>=0.24.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.1.5)
    Requirement already satisfied: retrying>=1.3.3 in /usr/local/lib/python3.7/dist-packages (from plotly->catboost) (1.3.3)
    Requirement already satisfied: python-dateutil>=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (2.8.1)
    Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (2.4.7)
    Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (1.3.1)
    Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (0.10.0)
    Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.24.0->catboost) (2018.9)
    Installing collected packages: catboost
    Successfully installed catboost-0.25.1



```python
import warnings
warnings.filterwarnings('ignore')
import numpy as np
import pandas as pd   
import matplotlib.pyplot as plt
import seaborn as sns
import itertools

from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, confusion_matrix, log_loss

from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier

from xgboost import XGBClassifier
from lightgbm import LGBMClassifier
from catboost import CatBoostClassifier
from sklearn import svm
from sklearn.ensemble import RandomForestClassifier
```


```python
#import os
#os.chdir('../open')



```


```python
train=pd.read_csv('train.csv')
test=pd.read_csv('test.csv')
submission=pd.read_csv('sample_submission.csv')
```

# **[Îç∞Ïù¥ÌÑ∞ ÏÇ¥Ìé¥Î≥¥Í∏∞]**


```python
train.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 26457 entries, 0 to 26456
    Data columns (total 20 columns):
     #   Column         Non-Null Count  Dtype  
    ---  ------         --------------  -----  
     0   index          26457 non-null  int64  
     1   gender         26457 non-null  object 
     2   car            26457 non-null  object 
     3   reality        26457 non-null  object 
     4   child_num      26457 non-null  int64  
     5   income_total   26457 non-null  float64
     6   income_type    26457 non-null  object 
     7   edu_type       26457 non-null  object 
     8   family_type    26457 non-null  object 
     9   house_type     26457 non-null  object 
     10  DAYS_BIRTH     26457 non-null  int64  
     11  DAYS_EMPLOYED  26457 non-null  int64  
     12  FLAG_MOBIL     26457 non-null  int64  
     13  work_phone     26457 non-null  int64  
     14  phone          26457 non-null  int64  
     15  email          26457 non-null  int64  
     16  occyp_type     18286 non-null  object 
     17  family_size    26457 non-null  float64
     18  begin_month    26457 non-null  float64
     19  credit         26457 non-null  float64
    dtypes: float64(4), int64(8), object(8)
    memory usage: 4.0+ MB



```python
train.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>child_num</th>
      <th>income_total</th>
      <th>DAYS_BIRTH</th>
      <th>DAYS_EMPLOYED</th>
      <th>FLAG_MOBIL</th>
      <th>work_phone</th>
      <th>phone</th>
      <th>email</th>
      <th>family_size</th>
      <th>begin_month</th>
      <th>credit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>2.645700e+04</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>26457.0</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>13228.000000</td>
      <td>0.428658</td>
      <td>1.873065e+05</td>
      <td>-15958.053899</td>
      <td>59068.750728</td>
      <td>1.0</td>
      <td>0.224742</td>
      <td>0.294251</td>
      <td>0.091280</td>
      <td>2.196848</td>
      <td>-26.123294</td>
      <td>1.519560</td>
    </tr>
    <tr>
      <th>std</th>
      <td>7637.622372</td>
      <td>0.747326</td>
      <td>1.018784e+05</td>
      <td>4201.589022</td>
      <td>137475.427503</td>
      <td>0.0</td>
      <td>0.417420</td>
      <td>0.455714</td>
      <td>0.288013</td>
      <td>0.916717</td>
      <td>16.559550</td>
      <td>0.702283</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.700000e+04</td>
      <td>-25152.000000</td>
      <td>-15713.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>-60.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>6614.000000</td>
      <td>0.000000</td>
      <td>1.215000e+05</td>
      <td>-19431.000000</td>
      <td>-3153.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>-39.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>13228.000000</td>
      <td>0.000000</td>
      <td>1.575000e+05</td>
      <td>-15547.000000</td>
      <td>-1539.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>-24.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>19842.000000</td>
      <td>1.000000</td>
      <td>2.250000e+05</td>
      <td>-12446.000000</td>
      <td>-407.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>-12.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>26456.000000</td>
      <td>19.000000</td>
      <td>1.575000e+06</td>
      <td>-7705.000000</td>
      <td>365243.000000</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>20.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.describe().columns
```




    Index(['index', 'child_num', 'income_total', 'DAYS_BIRTH', 'DAYS_EMPLOYED',
           'FLAG_MOBIL', 'work_phone', 'phone', 'email', 'family_size',
           'begin_month', 'credit'],
          dtype='object')




```python
temp = train['DAYS_BIRTH']//365
```


```python
temp.describe()
```




    count    26457.000000
    mean       -44.211248
    std         11.512586
    min        -69.000000
    25%        -54.000000
    50%        -43.000000
    75%        -35.000000
    max        -22.000000
    Name: DAYS_BIRTH, dtype: float64




```python
temp2 = train['DAYS_EMPLOYED'] // 365
temp2.describe()
```




    count    26457.000000
    mean       161.303247
    std        376.583727
    min        -44.000000
    25%         -9.000000
    50%         -5.000000
    75%         -2.000000
    max       1000.000000
    Name: DAYS_EMPLOYED, dtype: float64




```python
#Îã®Î≥ÄÏàò ÌÉêÏÉâÏùÄ seaborn Ìå®ÌÇ§ÏßÄÏùò distplot Ìï®ÏàòÎ•º Ïù¥Ïö©ÌïòÎ©¥ Îß§Ïö∞ Ìé∏Ìï©ÎãàÎã§.



#Ïö∞ÏÑ† Ïù¥ÏôÄ Í∞ôÏù¥ Ï†ÑÏ≤¥ Î≥ÄÏàò Ï§ëÏóêÏÑú Î≤îÏ£ºÌòï Î≥ÄÏàòÏôÄ Í∏∞ÌÉÄ Ïù∏Îç±Ïä§ Î≥ÄÏàò, Ï¢ÖÏÜçÎ≥ÄÏàòÎì§ÏùÑ Ï†úÏô∏ÌïòÍ≥† ÏàòÏπòÌòï Î≥ÄÏàòÎßå Í≥®ÎùºÎÉÖÎãàÎã§.

numerical_feature = ['index', 'child_num', 'income_total', 'DAYS_BIRTH', 'DAYS_EMPLOYED',
       'FLAG_MOBIL', 'work_phone', 'phone', 'email', 'family_size',
       'begin_month', 'credit']

numerical_feature = np.sort(numerical_feature)
#numerical_feature
#Î≥ÄÏàòÎ≥ÑÎ°ú forÎ¨∏ÏùÑ ÎèåÎ©¥ÏÑú distplotÏùÑ Í∑∏Î¶ΩÎãàÎã§



for col in numerical_feature:
    sns.distplot(train.loc[train[col].notnull(), col])
    plt.title(col)
    plt.show()


#Ï∂úÏ≤ò: https://3months.tistory.com/325 [Deep Play]
```


    
![png](output_12_0.png)
    



    
![png](output_12_1.png)
    



    
![png](output_12_2.png)
    



    
![png](output_12_3.png)
    



    
![png](output_12_4.png)
    



    
![png](output_12_5.png)
    



    
![png](output_12_6.png)
    



    
![png](output_12_7.png)
    



    
![png](output_12_8.png)
    



    
![png](output_12_9.png)
    



    
![png](output_12_10.png)
    



    
![png](output_12_11.png)
    



```python
temp = train['DAYS_EMPLOYED']
temp.describe()
```




    count     26457.000000
    mean      59068.750728
    std      137475.427503
    min      -15713.000000
    25%       -3153.000000
    50%       -1539.000000
    75%        -407.000000
    max      365243.000000
    Name: DAYS_EMPLOYED, dtype: float64




```python
temp.isnull().sum()
```




    0




```python
temp2 = train['email']
temp2.describe()
```




    count    26457.000000
    mean         0.091280
    std          0.288013
    min          0.000000
    25%          0.000000
    50%          0.000000
    75%          0.000000
    max          1.000000
    Name: email, dtype: float64




```python
temp2.isnull().sum()
```




    0




```python
train['phone'].isnull().sum()

```




    0




```python
train['work_phone'].isnull().sum()
```




    0



## ÎäêÎÇÄÏ†ê
- 1Î≤à. 'DAYS_EMPLOYED'
- ÏùåÏàòÏóêÏÑú Ìïú Î¥âÏò§Î¶¨, ÏñëÏàòÏóêÏÑú Ìïú Î¥âÏò§Î¶¨ Ìï¥ÏÑú 2Í∞úÍ∞Ä Î≥¥ÏûÑ ? -> Í≥†Ïö©Ï§ë/Î∞±ÏàòÎ°ú 1/0ÏúºÎ°ú Íµ¨Î∂ÑÌï¥Î≥¥Í∏∞

--
- 2Î≤à. FLAG_MOBIL & email & phone & work_phone
- Ìï∏ÎìúÌè∞ ÏÜåÏú† Ïó¨Î∂ÄÎ•º ÎÇòÌÉÄÎÇ¥Îäî categorical Î≥ÄÏàòÏù¥Í≥†, Í≤∞Ï∏°ÏπòÎèÑ ÏóÜÎäîÎç∞ intÌòï Î≥ÄÏàòÎ°ú Ï∑®Í∏âÎêòÏñ¥ ÏûàÏùå -> categorical Î≤îÏ£ºÌòïÏúºÎ°ú Î≥ÄÍ≤ΩÌï¥Ï£ºÍ∏∞



```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>gender</th>
      <th>car</th>
      <th>reality</th>
      <th>child_num</th>
      <th>income_total</th>
      <th>income_type</th>
      <th>edu_type</th>
      <th>family_type</th>
      <th>house_type</th>
      <th>DAYS_BIRTH</th>
      <th>DAYS_EMPLOYED</th>
      <th>FLAG_MOBIL</th>
      <th>work_phone</th>
      <th>phone</th>
      <th>email</th>
      <th>occyp_type</th>
      <th>family_size</th>
      <th>begin_month</th>
      <th>credit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>F</td>
      <td>N</td>
      <td>N</td>
      <td>0</td>
      <td>202500.0</td>
      <td>Commercial associate</td>
      <td>Higher education</td>
      <td>Married</td>
      <td>Municipal apartment</td>
      <td>-13899</td>
      <td>-4709</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>-6.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>1</td>
      <td>247500.0</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Civil marriage</td>
      <td>House / apartment</td>
      <td>-11380</td>
      <td>-1540</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>Laborers</td>
      <td>3.0</td>
      <td>-5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>M</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>450000.0</td>
      <td>Working</td>
      <td>Higher education</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-19087</td>
      <td>-4434</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Managers</td>
      <td>2.0</td>
      <td>-22.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>202500.0</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-15088</td>
      <td>-2092</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Sales staff</td>
      <td>2.0</td>
      <td>-37.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>F</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>157500.0</td>
      <td>State servant</td>
      <td>Higher education</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-15037</td>
      <td>-2105</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Managers</td>
      <td>2.0</td>
      <td>-26.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>gender</th>
      <th>car</th>
      <th>reality</th>
      <th>child_num</th>
      <th>income_total</th>
      <th>income_type</th>
      <th>edu_type</th>
      <th>family_type</th>
      <th>house_type</th>
      <th>DAYS_BIRTH</th>
      <th>DAYS_EMPLOYED</th>
      <th>FLAG_MOBIL</th>
      <th>work_phone</th>
      <th>phone</th>
      <th>email</th>
      <th>occyp_type</th>
      <th>family_size</th>
      <th>begin_month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26457</td>
      <td>M</td>
      <td>Y</td>
      <td>N</td>
      <td>0</td>
      <td>112500.0</td>
      <td>Pensioner</td>
      <td>Secondary / secondary special</td>
      <td>Civil marriage</td>
      <td>House / apartment</td>
      <td>-21990</td>
      <td>365243</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>-60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26458</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>135000.0</td>
      <td>State servant</td>
      <td>Higher education</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-18964</td>
      <td>-8671</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Core staff</td>
      <td>2.0</td>
      <td>-36.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26459</td>
      <td>F</td>
      <td>N</td>
      <td>Y</td>
      <td>0</td>
      <td>69372.0</td>
      <td>Working</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-15887</td>
      <td>-217</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>Laborers</td>
      <td>2.0</td>
      <td>-40.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26460</td>
      <td>M</td>
      <td>Y</td>
      <td>N</td>
      <td>0</td>
      <td>112500.0</td>
      <td>Commercial associate</td>
      <td>Secondary / secondary special</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-19270</td>
      <td>-2531</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>Drivers</td>
      <td>2.0</td>
      <td>-41.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26461</td>
      <td>F</td>
      <td>Y</td>
      <td>Y</td>
      <td>0</td>
      <td>225000.0</td>
      <td>State servant</td>
      <td>Higher education</td>
      <td>Married</td>
      <td>House / apartment</td>
      <td>-17822</td>
      <td>-9385</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>Managers</td>
      <td>2.0</td>
      <td>-8.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.shape
```




    (26457, 20)




```python
test.shape
```




    (10000, 19)




```python
train.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 26457 entries, 0 to 26456
    Data columns (total 20 columns):
     #   Column         Non-Null Count  Dtype  
    ---  ------         --------------  -----  
     0   index          26457 non-null  int64  
     1   gender         26457 non-null  object 
     2   car            26457 non-null  object 
     3   reality        26457 non-null  object 
     4   child_num      26457 non-null  int64  
     5   income_total   26457 non-null  float64
     6   income_type    26457 non-null  object 
     7   edu_type       26457 non-null  object 
     8   family_type    26457 non-null  object 
     9   house_type     26457 non-null  object 
     10  DAYS_BIRTH     26457 non-null  int64  
     11  DAYS_EMPLOYED  26457 non-null  int64  
     12  FLAG_MOBIL     26457 non-null  int64  
     13  work_phone     26457 non-null  int64  
     14  phone          26457 non-null  int64  
     15  email          26457 non-null  int64  
     16  occyp_type     18286 non-null  object 
     17  family_size    26457 non-null  float64
     18  begin_month    26457 non-null  float64
     19  credit         26457 non-null  float64
    dtypes: float64(4), int64(8), object(8)
    memory usage: 4.0+ MB


## Ï≤òÎ¶¨


```python
train['FLAG_MOBIL'] = train['FLAG_MOBIL'].astype(object)
train['email'] = train['email'].astype(object)
train['phone'] = train['phone'].astype(object)
train['work_phone'] = train['work_phone'].astype(object)
```


```python
DAYS_EMPLOYED_copy = list(train['DAYS_EMPLOYED'])

train['DAYS_EMPLOYED'] = [1 if values < 0 else 0 for values in DAYS_EMPLOYED_copy]
```


```python
DAYS_EMPLOYED_copy
```




    [-4709,
     -1540,
     -4434,
     -2092,
     -2105,
     -4996,
     -1978,
     -5420,
     -1466,
     -1308,
     -2213,
     -91,
     -2162,
     -2474,
     365243,
     -4056,
     -4553,
     -984,
     365243,
     -6031,
     -1753,
     365243,
     -1357,
     -444,
     365243,
     -3694,
     -3353,
     -3500,
     -2325,
     -1711,
     -227,
     -3452,
     -1628,
     -346,
     -1630,
     -2433,
     -1022,
     -1646,
     -3472,
     -1600,
     -2426,
     -433,
     -554,
     -1876,
     -199,
     -3200,
     365243,
     -3482,
     365243,
     -2010,
     -1101,
     -1101,
     365243,
     -3965,
     -422,
     -3010,
     -9391,
     -642,
     365243,
     365243,
     365243,
     -1371,
     -3153,
     -3337,
     -716,
     -4936,
     -2783,
     -1216,
     -1610,
     -2969,
     -1928,
     -3787,
     -1081,
     365243,
     -219,
     -5500,
     -586,
     -520,
     -231,
     -1672,
     -212,
     -962,
     -1423,
     -1700,
     365243,
     -1215,
     -451,
     -235,
     -5427,
     -4145,
     -9404,
     -2988,
     -691,
     -3629,
     365243,
     365243,
     -2087,
     -1212,
     -588,
     -12332,
     -8491,
     -3046,
     -604,
     -3720,
     -2537,
     -2606,
     -1959,
     -1678,
     -683,
     -2234,
     -164,
     -2371,
     -201,
     -1138,
     -2944,
     365243,
     -2751,
     -674,
     -5756,
     -1854,
     365243,
     -9988,
     -4120,
     -6226,
     -3357,
     -4039,
     -4983,
     -410,
     -5221,
     -1749,
     -3234,
     -5330,
     -429,
     -2574,
     365243,
     -196,
     -399,
     -3246,
     365243,
     -982,
     -1680,
     -3000,
     -1934,
     -1071,
     -1322,
     -11940,
     -7400,
     -709,
     -808,
     -2379,
     -2828,
     -314,
     -574,
     -3476,
     -10993,
     365243,
     -880,
     -1447,
     -2355,
     365243,
     -1266,
     -839,
     -2045,
     365243,
     -829,
     -895,
     365243,
     -119,
     -9870,
     -3792,
     -678,
     -869,
     -8091,
     365243,
     -1040,
     -1376,
     -9957,
     -1415,
     365243,
     -2026,
     -4814,
     365243,
     -961,
     365243,
     -995,
     -2227,
     -1809,
     -4239,
     365243,
     -4574,
     365243,
     365243,
     -1628,
     -2574,
     -1650,
     -552,
     -2289,
     -2554,
     -5394,
     -658,
     -1953,
     -3717,
     -4447,
     -4031,
     -1207,
     -673,
     -2745,
     -1345,
     -2721,
     365243,
     -1672,
     -2380,
     -354,
     -2045,
     365243,
     -2011,
     -7310,
     365243,
     365243,
     -2836,
     365243,
     -1925,
     -1830,
     -1128,
     -5792,
     -4491,
     -1327,
     -3246,
     -1221,
     365243,
     -11062,
     365243,
     -492,
     -7679,
     -923,
     -401,
     -1321,
     -6649,
     -158,
     -140,
     -4174,
     -3141,
     -1353,
     -762,
     -5239,
     -3380,
     -7514,
     -3021,
     -626,
     -1063,
     -2267,
     365243,
     -3480,
     -6835,
     -734,
     -3485,
     -3560,
     365243,
     -3291,
     -4596,
     -1882,
     -6586,
     -2326,
     -2665,
     365243,
     -1346,
     -2971,
     365243,
     -1539,
     -1963,
     -1631,
     -1792,
     365243,
     -561,
     -169,
     -3574,
     365243,
     -149,
     -7049,
     365243,
     -2685,
     365243,
     365243,
     -2682,
     365243,
     -4081,
     -5639,
     -869,
     -923,
     -727,
     -4549,
     -801,
     -2139,
     365243,
     -1156,
     -1991,
     -1550,
     -840,
     -1206,
     -2086,
     -2879,
     -1565,
     -703,
     -1009,
     365243,
     -4827,
     -3680,
     -4305,
     -2990,
     -4904,
     -3627,
     -1292,
     -889,
     -8671,
     -5507,
     -3992,
     -4090,
     365243,
     -2052,
     -399,
     -1285,
     -2578,
     -1003,
     -731,
     -3185,
     -663,
     -401,
     -6383,
     -1630,
     -302,
     -12332,
     -611,
     -10773,
     -169,
     -991,
     -8284,
     -1218,
     -3347,
     365243,
     -157,
     -1986,
     -101,
     -1974,
     365243,
     -2299,
     365243,
     -1774,
     -1589,
     -1509,
     -765,
     -1431,
     -10121,
     -399,
     -1953,
     -3577,
     -1193,
     -1387,
     365243,
     365243,
     -3170,
     -3000,
     -5469,
     365243,
     -2866,
     365243,
     365243,
     -4493,
     -7369,
     -1782,
     -3840,
     -3731,
     -796,
     -1100,
     -521,
     -2537,
     365243,
     -5176,
     -597,
     -2349,
     -1661,
     -12278,
     -7415,
     -1245,
     365243,
     -1905,
     -1192,
     -3076,
     -4631,
     -979,
     -1308,
     365243,
     -3088,
     -217,
     -1100,
     -521,
     -2324,
     365243,
     365243,
     -2686,
     365243,
     -672,
     -2864,
     365243,
     365243,
     -200,
     -3785,
     365243,
     365243,
     -991,
     -2877,
     -7401,
     365243,
     -1816,
     365243,
     -285,
     -4369,
     -1912,
     -196,
     -295,
     -3185,
     -1467,
     -1322,
     -430,
     -4423,
     -1958,
     365243,
     -3804,
     -3153,
     -10050,
     365243,
     -2165,
     -1172,
     -2871,
     -211,
     -3273,
     365243,
     -1556,
     -1078,
     -3092,
     365243,
     365243,
     -2495,
     -5269,
     -2044,
     -703,
     -5370,
     365243,
     365243,
     -1539,
     365243,
     -3242,
     -8553,
     -3059,
     365243,
     -198,
     -339,
     -7593,
     -3000,
     -1610,
     -157,
     -2355,
     -1101,
     -1323,
     -1632,
     -1233,
     -1730,
     -2250,
     -1315,
     -4630,
     -1131,
     -11494,
     -1858,
     365243,
     -431,
     -6712,
     -803,
     -3535,
     365243,
     -3273,
     -1160,
     -731,
     -4663,
     -4357,
     -165,
     365243,
     -3437,
     -1448,
     -1557,
     -2174,
     -98,
     -1565,
     -4614,
     -2758,
     365243,
     -4887,
     -1962,
     -1138,
     -1235,
     -315,
     365243,
     365243,
     365243,
     365243,
     -230,
     -837,
     -1235,
     -7401,
     365243,
     365243,
     365243,
     -888,
     -3335,
     -1478,
     -908,
     -622,
     365243,
     -919,
     365243,
     -9052,
     -801,
     365243,
     -309,
     -1812,
     -4219,
     365243,
     -858,
     -1842,
     -1649,
     -1282,
     365243,
     -1203,
     -6400,
     -622,
     -5726,
     -9269,
     -2628,
     -1628,
     -2197,
     -1904,
     -1923,
     -1353,
     -1493,
     -515,
     -3595,
     365243,
     -1649,
     365243,
     -1912,
     -1842,
     -561,
     -6904,
     -560,
     -1022,
     -2654,
     -1204,
     -1518,
     -2316,
     365243,
     -553,
     -2384,
     -1305,
     -3195,
     -5190,
     -3484,
     -2361,
     -1710,
     -1022,
     -5500,
     365243,
     -2842,
     365243,
     -671,
     365243,
     -3243,
     -5788,
     365243,
     -4117,
     -882,
     365243,
     -2969,
     -4239,
     -2324,
     -962,
     -5155,
     -1923,
     -992,
     -614,
     -1670,
     365243,
     -1184,
     -1904,
     -1520,
     365243,
     365243,
     -3010,
     -978,
     -5587,
     365243,
     -1287,
     365243,
     -3034,
     -2043,
     365243,
     -2665,
     365243,
     -2452,
     -7835,
     -127,
     365243,
     -2175,
     -1359,
     -2470,
     -1107,
     -5014,
     -2545,
     -407,
     -622,
     -563,
     365243,
     -461,
     -2554,
     365243,
     -3030,
     365243,
     -581,
     -259,
     -1350,
     -6849,
     -1437,
     365243,
     365243,
     365243,
     -901,
     -354,
     -720,
     -1159,
     -3050,
     -696,
     -854,
     -3243,
     -4019,
     -2773,
     -1724,
     -2987,
     -122,
     -3079,
     -193,
     -3234,
     -4327,
     365243,
     -4469,
     365243,
     -961,
     -3453,
     -6067,
     -4690,
     -596,
     -2212,
     -734,
     365243,
     -857,
     -1362,
     -2196,
     -3694,
     365243,
     -7127,
     -2987,
     -1292,
     -3110,
     -9683,
     365243,
     -3339,
     -181,
     -96,
     -2754,
     365243,
     -1854,
     -7401,
     -1569,
     -2349,
     -1740,
     -3647,
     -2875,
     -2135,
     -9858,
     -1966,
     -2011,
     -2086,
     -4039,
     -3680,
     -1410,
     -7346,
     365243,
     -5179,
     -1953,
     -5711,
     -1740,
     -2959,
     -3805,
     -3099,
     -110,
     -3337,
     -4599,
     -2339,
     -10490,
     -4904,
     365243,
     -2054,
     -2773,
     -863,
     -801,
     -6039,
     -622,
     -286,
     365243,
     365243,
     365243,
     -3234,
     365243,
     365243,
     365243,
     -674,
     -1050,
     365243,
     365243,
     -1213,
     -2607,
     -2055,
     -1373,
     -3805,
     -2102,
     -3870,
     365243,
     -3093,
     -1133,
     -492,
     -1565,
     -444,
     365243,
     -3883,
     -2811,
     -1392,
     -380,
     -4004,
     365243,
     -3837,
     -2829,
     -200,
     -2531,
     365243,
     -2164,
     365243,
     -964,
     365243,
     -7048,
     -1751,
     -195,
     -9925,
     -109,
     -3489,
     -221,
     -321,
     -1350,
     -1172,
     -882,
     -546,
     -1912,
     -2417,
     365243,
     -2426,
     365243,
     -807,
     365243,
     365243,
     -599,
     -890,
     -1527,
     -2646,
     365243,
     -3684,
     -412,
     -9029,
     -786,
     -3541,
     -2530,
     -1632,
     365243,
     365243,
     -2682,
     -2805,
     -1160,
     -3292,
     -4397,
     -921,
     -925,
     -7080,
     365243,
     -2026,
     -1437,
     -3472,
     -7838,
     -1696,
     -1101,
     365243,
     -1070,
     365243,
     -2564,
     -7553,
     -171,
     365243,
     365243,
     -1285,
     -7379,
     -349,
     -2758,
     -464,
     -2357,
     365243,
     -5788,
     -1741,
     365243,
     -422,
     -2407,
     -1022,
     -2104,
     -593,
     -1749,
     -4813,
     -2027,
     -1350,
     -1379,
     365243,
     -1900,
     -6884,
     -2165,
     -121,
     365243,
     -3488,
     -1214,
     -444,
     -1678,
     -8171,
     -3243,
     -2324,
     -693,
     -857,
     365243,
     -1261,
     -1565,
     -4663,
     -2966,
     365243,
     -3913,
     -3993,
     -764,
     -1557,
     365243,
     -8375,
     -2988,
     365243,
     365243,
     -1194,
     365243,
     -3403,
     -1195,
     -993,
     -135,
     -1748,
     -2196,
     -1447,
     -229,
     -1495,
     365243,
     -5466,
     -704,
     -2578,
     -2696,
     -4663,
     -4546,
     365243,
     -5520,
     -1631,
     -980,
     -1236,
     365243,
     -4452,
     -2026,
     -5581,
     -3234,
     -1204,
     -3573,
     -837,
     -2317,
     -248,
     -2351,
     -6558,
     -3458,
     -1688,
     -2441,
     -2170,
     -933,
     -7536,
     -3034,
     -444,
     -1236,
     365243,
     -198,
     -2415,
     -1953,
     -1587,
     -354,
     -995,
     -2287,
     -200,
     -827,
     -412,
     -1518,
     -3420,
     -139,
     -306,
     -7264,
     -928,
     -734,
     -626,
     -302,
     365243,
     -3716,
     -3630,
     -3476,
     -2170,
     -6105,
     -156,
     365243,
     -10600,
     -203,
     -195,
     -949,
     -250,
     -3500,
     -513,
     -3174,
     -2433,
     -712,
     -11940,
     365243,
     -1160,
     365243,
     -913,
     -900,
     -2441,
     -7851,
     -2696,
     -622,
     365243,
     -2659,
     -1140,
     365243,
     365243,
     -638,
     -2357,
     -4707,
     -5355,
     -9575,
     -1151,
     -714,
     -218,
     365243,
     -96,
     -5764,
     -747,
     -2939,
     -3170,
     365243,
     -1962,
     365243,
     -2847,
     -3611,
     -3717,
     365243,
     -1283,
     -1679,
     365243,
     -7369,
     -341,
     -501,
     -3626,
     -1151,
     -4491,
     -1318,
     365243,
     365243,
     365243,
     -1904,
     -4881,
     -2866,
     -1401,
     365243,
     -1583,
     -1734,
     -672,
     ...]




```python
train['DAYS_EMPLOYED'].describe()
```




    count    26457.000000
    mean         0.832256
    std          0.373646
    min          0.000000
    25%          1.000000
    50%          1.000000
    75%          1.000000
    max          1.000000
    Name: DAYS_EMPLOYED, dtype: float64




```python
# Î≤îÏ£ºÌòï Î≥ÄÏàòÎ°ú Ï∂îÍ∞Ä Î≥ÄÌôò
train['DAYS_EMPLOYED'] = train['DAYS_EMPLOYED'].astype(object)
```

## Ï∂îÍ∞Ä Í≥†ÎØº



```python
train.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>child_num</th>
      <th>income_total</th>
      <th>DAYS_BIRTH</th>
      <th>family_size</th>
      <th>begin_month</th>
      <th>credit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>2.645700e+04</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
      <td>26457.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>13228.000000</td>
      <td>0.428658</td>
      <td>1.873065e+05</td>
      <td>-15958.053899</td>
      <td>2.196848</td>
      <td>-26.123294</td>
      <td>1.519560</td>
    </tr>
    <tr>
      <th>std</th>
      <td>7637.622372</td>
      <td>0.747326</td>
      <td>1.018784e+05</td>
      <td>4201.589022</td>
      <td>0.916717</td>
      <td>16.559550</td>
      <td>0.702283</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.700000e+04</td>
      <td>-25152.000000</td>
      <td>1.000000</td>
      <td>-60.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>6614.000000</td>
      <td>0.000000</td>
      <td>1.215000e+05</td>
      <td>-19431.000000</td>
      <td>2.000000</td>
      <td>-39.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>13228.000000</td>
      <td>0.000000</td>
      <td>1.575000e+05</td>
      <td>-15547.000000</td>
      <td>2.000000</td>
      <td>-24.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>19842.000000</td>
      <td>1.000000</td>
      <td>2.250000e+05</td>
      <td>-12446.000000</td>
      <td>3.000000</td>
      <td>-12.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>26456.000000</td>
      <td>19.000000</td>
      <td>1.575000e+06</td>
      <td>-7705.000000</td>
      <td>20.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
# begin_month

train['begin_month'].isnull().sum()
```




    0




```python
# child_num

train['child_num'].isnull().sum()
```




    0




```python
numerical_feature = ['index',	'child_num',	'income_total',	'DAYS_BIRTH',	'family_size',	'begin_month',	'credit']

numerical_feature = np.sort(numerical_feature)
#numerical_feature
#Î≥ÄÏàòÎ≥ÑÎ°ú forÎ¨∏ÏùÑ ÎèåÎ©¥ÏÑú distplotÏùÑ Í∑∏Î¶ΩÎãàÎã§



for col in numerical_feature:
    sns.distplot(train.loc[train[col].notnull(), col])
    plt.title(col)
    plt.show()
```


    
![png](output_35_0.png)
    



    
![png](output_35_1.png)
    



    
![png](output_35_2.png)
    



    
![png](output_35_3.png)
    



    
![png](output_35_4.png)
    



    
![png](output_35_5.png)
    



    
![png](output_35_6.png)
    


## ÏùòÎ¨∏ (Ï∂îÌõÑ)

- 'begin_month'ÏôÄ	'credit'Ïùò ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ ?
- 'child_num'ÏôÄ 'credit'Ïùò ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ ?
- 'income_total'ÏôÄ 'credit'Ïùò ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ ?

## Ï≤òÎ¶¨ (test Îç∞Ïù¥ÌÑ∞ÏóêÎèÑ ÎèôÏùºÌïú Ï≤òÎ¶¨ Î∞òÎ≥µ)


```python
test['FLAG_MOBIL'] = test['FLAG_MOBIL'].astype(object)
test['email'] = test['email'].astype(object)
test['phone'] = test['phone'].astype(object)
test['work_phone'] = test['work_phone'].astype(object)
```


```python
DAYS_EMPLOYED_copy2 = list(test['DAYS_EMPLOYED'])

test['DAYS_EMPLOYED'] = [1 if values < 0 else 0 for values in DAYS_EMPLOYED_copy2]
```


```python
DAYS_EMPLOYED_copy2
```




    [365243,
     -8671,
     -217,
     -2531,
     -9385,
     -2104,
     -2010,
     365243,
     -4451,
     -3504,
     365243,
     -1028,
     -1064,
     365243,
     365243,
     365243,
     365243,
     365243,
     365243,
     -481,
     -5190,
     -1478,
     -1619,
     -6014,
     -1345,
     -235,
     -1292,
     365243,
     -6276,
     365243,
     -233,
     -2506,
     365243,
     365243,
     -3092,
     -1565,
     -1342,
     365243,
     -1589,
     365243,
     -3447,
     -2602,
     365243,
     -472,
     -5119,
     -2988,
     -127,
     -3596,
     -2967,
     -1194,
     365243,
     365243,
     -2746,
     -1202,
     -316,
     365243,
     -3079,
     -137,
     -1155,
     365243,
     -1921,
     -2321,
     -3303,
     -2078,
     -5006,
     -3718,
     -238,
     -1193,
     365243,
     -3332,
     -1085,
     -652,
     -11494,
     -5107,
     -2967,
     365243,
     365243,
     -2747,
     -1628,
     -2778,
     -3999,
     -596,
     365243,
     365243,
     365243,
     365243,
     -117,
     -338,
     -3900,
     -3243,
     -2849,
     -1458,
     -3017,
     -1610,
     -1616,
     -3900,
     -3337,
     -6237,
     -2696,
     -1430,
     -2417,
     -2177,
     -7280,
     -8172,
     -1682,
     -1846,
     -400,
     -1137,
     -2133,
     365243,
     365243,
     -3778,
     -2593,
     365243,
     -531,
     365243,
     -1175,
     -3541,
     -2451,
     -339,
     -2987,
     365243,
     -3891,
     -3839,
     -808,
     -1077,
     -2045,
     365243,
     -2257,
     -3322,
     -15038,
     -6099,
     365243,
     -2616,
     -1346,
     -317,
     365243,
     365243,
     -4331,
     -7004,
     365243,
     365243,
     -4487,
     -2635,
     -5311,
     -235,
     -1005,
     365243,
     365243,
     -393,
     365243,
     -5950,
     -3227,
     -155,
     -2625,
     -1539,
     -2696,
     -8033,
     -703,
     -2569,
     -3595,
     365243,
     -3673,
     365243,
     -1325,
     -5239,
     -12870,
     365243,
     365243,
     -349,
     -5553,
     -2747,
     -2713,
     365243,
     -1101,
     -1802,
     -3334,
     -2971,
     -1677,
     -2330,
     -734,
     -5639,
     365243,
     -5239,
     -2087,
     -9029,
     365243,
     -3893,
     -6237,
     -2676,
     365243,
     -2745,
     -1904,
     -298,
     -1928,
     -674,
     -3119,
     365243,
     -3046,
     -958,
     -6342,
     -2331,
     -347,
     -6801,
     -852,
     -818,
     365243,
     -285,
     -4584,
     365243,
     365243,
     -3904,
     365243,
     -165,
     365243,
     -793,
     -131,
     -2574,
     -1235,
     -1782,
     -5386,
     -5921,
     -672,
     -1422,
     -7500,
     365243,
     -1430,
     -1740,
     -919,
     -3573,
     365243,
     -1711,
     -2230,
     -1648,
     -410,
     -1101,
     -3019,
     -5239,
     -5364,
     365243,
     -8808,
     365243,
     365243,
     -1661,
     -1626,
     365243,
     -1175,
     -321,
     -3099,
     -263,
     -1346,
     365243,
     -2713,
     365243,
     -118,
     -6853,
     -377,
     -1072,
     -1748,
     -5355,
     -1325,
     -1700,
     -2277,
     -1904,
     -1716,
     -1246,
     -3458,
     -1416,
     -1615,
     -2499,
     -1410,
     365243,
     -536,
     -979,
     -2622,
     -826,
     -7100,
     365243,
     -1782,
     -3988,
     -925,
     365243,
     -2256,
     -344,
     -3017,
     -4936,
     365243,
     -720,
     365243,
     -3693,
     -1751,
     -2712,
     -6099,
     -4663,
     -566,
     -3638,
     365243,
     -380,
     -5326,
     -875,
     -1727,
     -1140,
     -1194,
     -3079,
     -104,
     -1128,
     -4479,
     -3806,
     -468,
     365243,
     -2765,
     -2057,
     -1596,
     365243,
     -1236,
     -10110,
     -8639,
     -4097,
     -2207,
     -674,
     -1847,
     -980,
     -3092,
     -1596,
     -2827,
     -2265,
     -3208,
     -3902,
     -6099,
     -1071,
     -1014,
     -3243,
     365243,
     -7379,
     -2415,
     -5453,
     -1616,
     -1016,
     -5740,
     -2057,
     -3084,
     -839,
     365243,
     -819,
     -3904,
     -3873,
     -3017,
     -1678,
     -124,
     365243,
     -2057,
     -3174,
     -1477,
     -818,
     -5460,
     365243,
     -1656,
     -221,
     -3287,
     -808,
     -4354,
     -515,
     -1707,
     -2167,
     -1023,
     -1645,
     -7640,
     -3193,
     -165,
     -626,
     -716,
     -197,
     -3239,
     -1326,
     -2874,
     -309,
     -3574,
     -3000,
     -667,
     365243,
     -8509,
     -992,
     -8862,
     365243,
     -3515,
     -2454,
     -1677,
     -3375,
     -2734,
     -6237,
     -1135,
     -3335,
     -155,
     -1371,
     -9582,
     -250,
     -1603,
     -7733,
     -9975,
     -1585,
     -1250,
     -3327,
     -2316,
     -3235,
     -3742,
     365243,
     -2796,
     -413,
     -1039,
     -2481,
     -464,
     -900,
     -4814,
     -765,
     365243,
     -666,
     -2769,
     -2426,
     -101,
     -8460,
     -1800,
     -1222,
     -2512,
     -3347,
     -2747,
     365243,
     -1281,
     -1435,
     -10780,
     -1072,
     -502,
     -5237,
     -4029,
     -6801,
     -1126,
     -1357,
     365243,
     365243,
     -3078,
     365243,
     -4392,
     -1050,
     -6123,
     -2652,
     -3153,
     -6216,
     -2391,
     -1661,
     -555,
     -1266,
     365243,
     365243,
     -2266,
     -1328,
     -3908,
     -939,
     -777,
     -1610,
     -3535,
     -980,
     -2878,
     -1587,
     -5330,
     -623,
     -10758,
     365243,
     -4161,
     365243,
     -3506,
     -978,
     365243,
     -1648,
     -2175,
     -7804,
     -443,
     -3667,
     -2593,
     -2985,
     -1308,
     -370,
     -3509,
     -2174,
     -3344,
     -5321,
     -1160,
     -3488,
     -583,
     -2908,
     365243,
     -2833,
     -985,
     -1776,
     -2780,
     -8647,
     -2727,
     -8041,
     -3715,
     -298,
     -1570,
     -1678,
     -2381,
     -1751,
     365243,
     -2769,
     -1945,
     -3892,
     -3019,
     365243,
     -3148,
     365243,
     -367,
     -1009,
     -781,
     -2088,
     -926,
     365243,
     -1049,
     -1057,
     -3435,
     -943,
     -1388,
     -2174,
     -3844,
     -464,
     -1493,
     -1170,
     -2440,
     -1039,
     -3868,
     -9988,
     365243,
     -2860,
     365243,
     -4280,
     -5064,
     -2454,
     -890,
     -2805,
     -1702,
     -1749,
     -3259,
     -201,
     -767,
     -882,
     -2087,
     -158,
     -1371,
     -962,
     -1131,
     -657,
     -3529,
     -990,
     -399,
     -1138,
     -7614,
     365243,
     -2477,
     365243,
     365243,
     -620,
     -917,
     -926,
     -1493,
     -3970,
     -4242,
     365243,
     -825,
     -1678,
     -5992,
     -1707,
     -1922,
     -1802,
     -1649,
     -3234,
     -1981,
     -3266,
     -1785,
     -187,
     -667,
     -1327,
     -2014,
     -2670,
     -5555,
     -726,
     -14810,
     -200,
     -2959,
     365243,
     365243,
     -7522,
     -536,
     -137,
     -1294,
     -1144,
     -897,
     -4369,
     -1682,
     -3201,
     -1131,
     -2129,
     365243,
     365243,
     -4023,
     -338,
     -4617,
     -638,
     -2539,
     -11884,
     -1567,
     -1537,
     365243,
     365243,
     -742,
     -3413,
     -110,
     -681,
     365243,
     365243,
     -704,
     -4304,
     -5345,
     365243,
     -431,
     -7400,
     -1191,
     -1994,
     -6764,
     -110,
     -5148,
     -309,
     -1644,
     -2331,
     -254,
     -2174,
     365243,
     -2520,
     -747,
     -1379,
     -5362,
     -3141,
     365243,
     -3140,
     -1816,
     -795,
     -3140,
     365243,
     -808,
     -3944,
     -422,
     -3080,
     365243,
     -415,
     -1138,
     365243,
     -1254,
     -185,
     -4887,
     -2423,
     -727,
     -200,
     -3282,
     -734,
     -7400,
     -302,
     -2446,
     -3173,
     -1769,
     365243,
     365243,
     -3508,
     -3078,
     -1610,
     -4854,
     -5618,
     -3291,
     -982,
     -1615,
     -2330,
     -2802,
     365243,
     -5574,
     -3255,
     -93,
     -1401,
     -4770,
     -5082,
     -6221,
     -1562,
     -185,
     -2175,
     -3605,
     -7404,
     -5457,
     -1050,
     -2023,
     -1905,
     365243,
     -1976,
     -339,
     -2417,
     -2209,
     -3079,
     -4174,
     -1473,
     -1524,
     -7734,
     -1600,
     -2058,
     -4633,
     -3692,
     -716,
     -218,
     -3166,
     -1401,
     -1953,
     365243,
     -467,
     -2939,
     -5330,
     -825,
     -1931,
     -189,
     -670,
     -2484,
     365243,
     -1866,
     -1324,
     -402,
     -775,
     -536,
     365243,
     -4979,
     365243,
     -2758,
     -1800,
     -1682,
     -1388,
     365243,
     -762,
     -169,
     365243,
     -4003,
     -3747,
     -8175,
     -816,
     365243,
     -1626,
     -2318,
     -118,
     -3960,
     365243,
     365243,
     -1226,
     -2339,
     -2104,
     -11954,
     -4561,
     -1373,
     -229,
     -1688,
     -390,
     -2175,
     365243,
     -5221,
     -763,
     -1069,
     -2687,
     365243,
     -4145,
     -704,
     -1672,
     -2349,
     365243,
     -2196,
     -5557,
     365243,
     -4781,
     -5488,
     -1478,
     365243,
     -2501,
     -2942,
     -1315,
     -3476,
     -413,
     -1138,
     -3262,
     -7979,
     -3504,
     -1028,
     -3242,
     -3172,
     365243,
     -2437,
     -382,
     -5295,
     365243,
     365243,
     365243,
     -168,
     -6639,
     -2064,
     -413,
     -7979,
     -1434,
     -5587,
     -1672,
     -5707,
     -1800,
     -2746,
     -1315,
     365243,
     365243,
     -2875,
     -5857,
     -1562,
     -2697,
     -2727,
     -561,
     -1064,
     365243,
     -1384,
     -5633,
     -2060,
     -10094,
     -3407,
     365243,
     -2884,
     -3329,
     -773,
     -5622,
     -5336,
     365243,
     -3452,
     -362,
     -2389,
     -3779,
     -657,
     -1618,
     -882,
     365243,
     -1160,
     -5336,
     -1921,
     -1161,
     -212,
     -5467,
     -2796,
     -430,
     -1823,
     -1531,
     365243,
     -673,
     -3352,
     -1419,
     -3206,
     -1344,
     -2102,
     365243,
     -1081,
     365243,
     -1153,
     -1327,
     -1588,
     365243,
     -900,
     365243,
     -1093,
     365243,
     -5416,
     -3537,
     365243,
     -5373,
     -706,
     -2565,
     365243,
     365243,
     -469,
     -2326,
     -671,
     -401,
     -227,
     365243,
     -659,
     -226,
     -9325,
     -6094,
     -2750,
     -1328,
     -3756,
     -3700,
     -2317,
     -2036,
     -5553,
     -1236,
     -3050,
     -825,
     -1625,
     -1386,
     -17,
     -6640,
     -303,
     365243,
     -969,
     -7804,
     -4123,
     -492,
     -2901,
     -288,
     -2593,
     -8290,
     -6790,
     -2269,
     365243,
     -7627,
     365243,
     -401,
     -517,
     -990,
     -130,
     -719,
     -5330,
     -1726,
     -212,
     -6367,
     -2043,
     -5585,
     -2470,
     -2410,
     365243,
     -7735,
     -798,
     -2599,
     -10121,
     -2877,
     -3776,
     -3016,
     -3695,
     -7752,
     -3500,
     -1350,
     365243,
     -3026,
     -1539,
     -4813,
     365243,
     -3388,
     365243,
     365243,
     -1160,
     365243,
     -170,
     -3234,
     -2187,
     365243,
     -536,
     -6409,
     -2052,
     -257,
     -766,
     -218,
     365243,
     -6886,
     -4174,
     -7369,
     -470,
     -3673,
     -6517,
     365243,
     -4114,
     365243,
     -2068,
     -985,
     -1155,
     365243,
     -302,
     -4086,
     -5189,
     -413,
     -1283,
     -4526,
     -4033,
     -2403,
     -979,
     365243,
     -169,
     -917,
     365243,
     -2086,
     -463,
     365243,
     365243,
     -1281,
     -1266,
     -808,
     -4119,
     -566,
     -587,
     -3248,
     -4219,
     ...]




```python
test['DAYS_EMPLOYED'].describe()
```




    count    10000.000000
    mean         0.830300
    std          0.375388
    min          0.000000
    25%          1.000000
    50%          1.000000
    75%          1.000000
    max          1.000000
    Name: DAYS_EMPLOYED, dtype: float64




```python
# Î≤îÏ£ºÌòï Î≥ÄÏàòÎ°ú Ï∂îÍ∞Ä Î≥ÄÌôò
test['DAYS_EMPLOYED'] = test['DAYS_EMPLOYED'].astype(object)
```


```python

```

# **[Îç∞Ïù¥ÌÑ∞ Ï†ÑÏ≤òÎ¶¨]**


```python
data=pd.concat([train, test], axis=0)
data.shape
```




    (36457, 20)




```python
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 36457 entries, 0 to 9999
    Data columns (total 20 columns):
     #   Column         Non-Null Count  Dtype  
    ---  ------         --------------  -----  
     0   index          36457 non-null  int64  
     1   gender         36457 non-null  object 
     2   car            36457 non-null  object 
     3   reality        36457 non-null  object 
     4   child_num      36457 non-null  int64  
     5   income_total   36457 non-null  float64
     6   income_type    36457 non-null  object 
     7   edu_type       36457 non-null  object 
     8   family_type    36457 non-null  object 
     9   house_type     36457 non-null  object 
     10  DAYS_BIRTH     36457 non-null  int64  
     11  DAYS_EMPLOYED  36457 non-null  object 
     12  FLAG_MOBIL     36457 non-null  object 
     13  work_phone     36457 non-null  object 
     14  phone          36457 non-null  object 
     15  email          36457 non-null  object 
     16  occyp_type     25134 non-null  object 
     17  family_size    36457 non-null  float64
     18  begin_month    36457 non-null  float64
     19  credit         26457 non-null  float64
    dtypes: float64(4), int64(3), object(13)
    memory usage: 5.8+ MB


## **1. Í≤∞Ï∏°Ïπò Ï†úÍ±∞** 


```python
data.isnull().sum()
```




    index                0
    gender               0
    car                  0
    reality              0
    child_num            0
    income_total         0
    income_type          0
    edu_type             0
    family_type          0
    house_type           0
    DAYS_BIRTH           0
    DAYS_EMPLOYED        0
    FLAG_MOBIL           0
    work_phone           0
    phone                0
    email                0
    occyp_type       11323
    family_size          0
    begin_month          0
    credit           10000
    dtype: int64



## 'occyp_type'(ÏßÅÏóÖ Ïú†Ìòï)Ïù¥ Î≠îÎç∞ ?


```python

```

## Î≤îÏ£ºÌòï Î≥Ñ credit ÌååÏïÖ


```python
sns.histplot(x='credit', data=data, hue='car', kde=True)
## Í∑∏ÎÇòÎßà Ï°∞Í∏à 3 Í∑∏Î£π Î≥Ñ Y/NÏóê Ï∞®Ïù¥ ÏûàÏùå(?)
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7f8e4df6c710>




    
![png](output_52_1.png)
    



```python
train['car'].value_counts(normalize=True)*100
```




    N    62.025173
    Y    37.974827
    Name: car, dtype: float64




```python
data['car'].value_counts(normalize=True)*100
```




    N    62.02924
    Y    37.97076
    Name: car, dtype: float64




```python
sns.histplot(x='credit', data=data, hue='gender', kde=True)

## ÎÇ®/Ïó¨ ÏÑ±ÎπÑ Ï∞®Ïù¥Í∞Ä ÌÅ∞ Í≤ÉÏóê ÎπÑÌï¥ creditÏóêÏÑúÎäî 5:5 Ï†ïÎèÑÎ•º Î≥¥ÏûÑ (??)
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7f8e4de5fa90>




    
![png](output_55_1.png)
    



```python
data['gender'].value_counts(normalize=True)*100
```




    F    67.010451
    M    32.989549
    Name: gender, dtype: float64




```python
sns.histplot(x='credit', data=data, hue='reality', kde=True)

## Ïù¥Í≤ÉÎèÑ Íµ¨ÏÑ±ÎπÑ Ï∞®Ïù¥Í∞Ä ÌÅ∞ Í≤ÉÏóê ÎπÑÌï¥ creditÏóêÏÑúÎäî 5:5 Ï†ïÎèÑÎ•º Î≥¥ÏûÑ (??)
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7f8e4dd25f90>




    
![png](output_57_1.png)
    



```python
data['reality'].value_counts(normalize=True)*100
```




    Y    67.218915
    N    32.781085
    Name: reality, dtype: float64




```python
data=data.drop('occyp_type', axis=1)
```


```python
data.isnull().sum()
```




    index                0
    gender               0
    car                  0
    reality              0
    child_num            0
    income_total         0
    income_type          0
    edu_type             0
    family_type          0
    house_type           0
    DAYS_BIRTH           0
    DAYS_EMPLOYED        0
    FLAG_MOBIL           0
    work_phone           0
    phone                0
    email                0
    family_size          0
    begin_month          0
    credit           10000
    dtype: int64



## ÌòÑÏû¨ floatÌòïÏù∏ 'family_size'ÏôÄ 'begin_month'Î•º Î≤îÏ£ºÌòï Í∑∏Î£πÎ≥ÑÎ°ú ÎÇòÎàÑÏñ¥Î≥¥Í∏∞ (Ï∂îÌõÑ)

## **2. Binary variables**


```python
data['gender'] = data['gender'].replace(['F','M'],[0,1])
print('gender :')
print(data['gender'].value_counts())
print('--------------')

print('Having a car or not : ')
data['car'] = data['car'].replace(['N','Y'],[0,1])
print(data['car'].value_counts())
print('--------------')

print('Having house reality or not: ')
data['reality'] = data['reality'].replace(['N','Y'],[0,1])
print(data['reality'].value_counts())
print('--------------')
      
print('Having a phone or not: ')
print(data['phone'].value_counts())
print('--------------')
      

print('Having a email or not: ')
print(data['email'].value_counts())
print('--------------')
      

print('Having a work phone or not: ')
print(data['work_phone'].value_counts())
print('--------------')
```

    gender :
    0    24430
    1    12027
    Name: gender, dtype: int64
    --------------
    Having a car or not : 
    0    22614
    1    13843
    Name: car, dtype: int64
    --------------
    Having house reality or not: 
    1    24506
    0    11951
    Name: reality, dtype: int64
    --------------
    Having a phone or not: 
    0    25709
    1    10748
    Name: phone, dtype: int64
    --------------
    Having a email or not: 
    0    33186
    1     3271
    Name: email, dtype: int64
    --------------
    Having a work phone or not: 
    0    28235
    1     8222
    Name: work_phone, dtype: int64
    --------------


## **3. Continuous variable**

### (1) child_num


```python
data['child_num'].value_counts(sort=False).plot.bar()
```




    <matplotlib.axes._subplots.AxesSubplot at 0x7f8e4db99d90>




    
![png](output_66_1.png)
    



```python
data.loc[data['child_num'] >= 2,'child_num']=2
```

### (2) inc


```python
data['income_total'] = data['income_total'].astype(object)
data['income_total'] = data['income_total']/10000 
print(data['income_total'].value_counts(bins=10,sort=False))
data['income_total'].plot(kind='hist',bins=50,density=True)
```

    (2.544, 18.18]      22460
    (18.18, 33.66]      11380
    (33.66, 49.14]       2099
    (49.14, 64.62]        274
    (64.62, 80.1]         165
    (80.1, 95.58]          58
    (95.58, 111.06]         4
    (111.06, 126.54]        3
    (126.54, 142.02]        6
    (142.02, 157.5]         8
    Name: income_total, dtype: int64





    <matplotlib.axes._subplots.AxesSubplot at 0x7f8e4dab48d0>




    
![png](output_69_2.png)
    



```python
count, bin_dividers =np.histogram(data['income_total'], bins=7)
bin_names=['ÏÜåÎìù'+str(i) for i in range(7) ]
data['income_total']=pd.cut(x=data['income_total'], bins=bin_dividers, labels=bin_names, include_lowest=True)
```

### **(3) Type**


```python
print(data['income_type'].unique())
print(data['edu_type'].unique())
print(data['family_type'].unique())
print(data['house_type'].unique())
```

    ['Commercial associate' 'Working' 'State servant' 'Pensioner' 'Student']
    ['Higher education' 'Secondary / secondary special' 'Incomplete higher'
     'Lower secondary' 'Academic degree']
    ['Married' 'Civil marriage' 'Separated' 'Single / not married' 'Widow']
    ['Municipal apartment' 'House / apartment' 'With parents'
     'Co-op apartment' 'Rented apartment' 'Office apartment']



```python
from sklearn import preprocessing
label_encoder=preprocessing.LabelEncoder()
data['income_type']=label_encoder.fit_transform(data['income_type'])
data['edu_type']=label_encoder.fit_transform(data['edu_type'])
data['family_type']=label_encoder.fit_transform(data['family_type'])
data['house_type']=label_encoder.fit_transform(data['house_type'])
data['income_total']=label_encoder.fit_transform(data['income_total'])
```

## **4. Minus continuous variable**


```python
#minus Î≥ÄÍ≤ΩÌïòÍ≥†
#Íµ¨Í∞ÑÌôî Ìï®Ïàò
def make_bin(variable, n):
    data[variable]=-data[variable]
    count, bin_dividers =np.histogram(data[variable], bins=n)
    bin_names=[str(i) for i in range(n)]
    data[variable]=pd.cut(x=data[variable], bins=bin_dividers, labels=bin_names, include_lowest=True)
    data[variable]=label_encoder.fit_transform(data[variable])
```


```python
data.columns
```




    Index(['index', 'gender', 'car', 'reality', 'child_num', 'income_total',
           'income_type', 'edu_type', 'family_type', 'house_type', 'DAYS_BIRTH',
           'DAYS_EMPLOYED', 'FLAG_MOBIL', 'work_phone', 'phone', 'email',
           'family_size', 'begin_month', 'credit'],
          dtype='object')




```python
make_bin('DAYS_BIRTH', n=10)
make_bin('DAYS_EMPLOYED', n=6)
make_bin('begin_month', n=4)
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>gender</th>
      <th>car</th>
      <th>reality</th>
      <th>child_num</th>
      <th>income_total</th>
      <th>income_type</th>
      <th>edu_type</th>
      <th>family_type</th>
      <th>house_type</th>
      <th>DAYS_BIRTH</th>
      <th>DAYS_EMPLOYED</th>
      <th>FLAG_MOBIL</th>
      <th>work_phone</th>
      <th>phone</th>
      <th>email</th>
      <th>family_size</th>
      <th>begin_month</th>
      <th>credit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2.0</td>
      <td>1</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2.0</td>
      <td>2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.0</td>
      <td>1</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>36452</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2.0</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>36453</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2.0</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>36454</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.0</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>36455</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2.0</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>36456</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>36457 rows √ó 19 columns</p>
</div>



# **[Îç∞Ïù¥ÌÑ∞ Î™®Îç∏ÎßÅ]**


```python
len(data)
```




    36457




```python
train=data[:len(data)-10000]
test=data[len(data)-10000:]
```


```python
train.shape
```




    (26457, 19)




```python
test.shape
```




    (10000, 19)




```python
train_x=train.drop('credit', axis=1)
train_y=train[['credit']]
test_x=test.drop('credit', axis=1)
```


```python
print(train_x.shape, train_y.shape, test_x.shape)
```

    (26457, 18) (26457, 1) (10000, 18)



```python
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, log_loss
from sklearn.metrics import f1_score
from tensorflow.keras.utils import to_categorical

X_train, X_val, y_train, y_val = train_test_split(train_x, train_y, 
                                                    stratify=train_y, test_size=0.25,
                                                    random_state = 10086)

print("Train set: ")
print(X_train.shape)
print(y_train.shape)
print("===========")
print("Validation set: ")
print(X_val.shape)
print(y_val.shape)


clf=RandomForestClassifier()
clf.fit(X_train, y_train)
y_pred=clf.predict_proba(X_val)

print(f"log_loss: {log_loss(to_categorical(y_val['credit']), y_pred)}")
```

    Train set: 
    (19842, 18)
    (19842, 1)
    ===========
    Validation set: 
    (6615, 18)
    (6615, 1)
    log_loss: 1.0216846496807834



```python
from sklearn.model_selection import KFold, StratifiedKFold

def run_kfold(clf):
    folds=StratifiedKFold(n_splits=5, shuffle=True, random_state=55)
    outcomes=[]
    sub=np.zeros((test_x.shape[0], 3))  
    for n_fold, (train_index, val_index) in enumerate(folds.split(train_x, train_y)):
        X_train, X_val = train_x.iloc[train_index], train_x.iloc[val_index]
        y_train, y_val = train_y.iloc[train_index], train_y.iloc[val_index]
        clf.fit(X_train, y_train)
        
        predictions=clf.predict_proba(X_val)
        
        logloss=log_loss(to_categorical(y_val['credit']), predictions)
        outcomes.append(logloss)
        print(f"FOLD {n_fold} : logloss:{logloss}")
        
        sub+=clf.predict_proba(test_x)
        
        
    mean_outcome=np.mean(outcomes)
    
    print("Mean:{}".format(mean_outcome))
    return sub/folds.n_splits

my_submission = run_kfold(clf)
```

    FOLD 0 : logloss:1.0333140740044047
    FOLD 1 : logloss:1.0226850625498909
    FOLD 2 : logloss:1.095757138167665
    FOLD 3 : logloss:1.0225988242866917
    FOLD 4 : logloss:1.1030794873676764
    Mean:1.0554869172752657



```python
my_submission
```




    array([[0.106, 0.178, 0.716],
           [0.09 , 0.254, 0.656],
           [0.066, 0.28 , 0.654],
           ...,
           [0.058, 0.126, 0.816],
           [0.112, 0.372, 0.516],
           [0.132, 0.378, 0.49 ]])




```python
submission
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26457</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26458</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26459</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26460</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26461</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>36452</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>36453</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>36454</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>36455</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>36456</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>10000 rows √ó 4 columns</p>
</div>




```python
submission.loc[:,1:]=my_submission
```


```python
submission
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26457</td>
      <td>0.106</td>
      <td>0.178</td>
      <td>0.716</td>
    </tr>
    <tr>
      <th>1</th>
      <td>26458</td>
      <td>0.090</td>
      <td>0.254</td>
      <td>0.656</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26459</td>
      <td>0.066</td>
      <td>0.280</td>
      <td>0.654</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26460</td>
      <td>0.100</td>
      <td>0.198</td>
      <td>0.702</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26461</td>
      <td>0.136</td>
      <td>0.376</td>
      <td>0.488</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>36452</td>
      <td>0.134</td>
      <td>0.322</td>
      <td>0.544</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>36453</td>
      <td>0.190</td>
      <td>0.350</td>
      <td>0.460</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>36454</td>
      <td>0.058</td>
      <td>0.126</td>
      <td>0.816</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>36455</td>
      <td>0.112</td>
      <td>0.372</td>
      <td>0.516</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>36456</td>
      <td>0.132</td>
      <td>0.378</td>
      <td>0.490</td>
    </tr>
  </tbody>
</table>
<p>10000 rows √ó 4 columns</p>
</div>




```python
##os.chdir('../baseline')
```


```python
submission.to_csv('../baseline_submission.csv', index=False) ## Ï†úÏ∂ú Ï†êÏàò:  0.87911
```
